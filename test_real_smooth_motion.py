#!/usr/bin/env python3
"""
æµ‹è¯•çœŸæ­£çš„å¹³æ»‘è¿åŠ¨æ§åˆ¶
å±•ç¤ºå…³èŠ‚è§’åº¦æ’å€¼ vs ä½ç½®è·³è·ƒçš„åŒºåˆ«
"""

import time

def demonstrate_smooth_concept():
    """æ¼”ç¤ºå¹³æ»‘è¿åŠ¨çš„æ¦‚å¿µ"""
    print("ğŸ¤– æœºæ¢°è‡‚å¹³æ»‘è¿åŠ¨åŸç†æ¼”ç¤º")
    print("=" * 60)
    
    print("\nâŒ åŸæ¥çš„é—®é¢˜ - ä½ç½®è·³è·ƒ:")
    print("   æ¯ä¸€æ­¥éƒ½é‡æ–°è®¡ç®—IKï¼Œç„¶åæœºæ¢°è‡‚ç¬é—´è·³åˆ°æ–°çš„å…³èŠ‚è§’åº¦")
    print("   å°±åƒè¿™æ ·:")
    
    # æ¨¡æ‹Ÿè·³è·ƒå¼è¿åŠ¨
    positions = [(0.0, -0.5, 0.5), (-0.04, -0.57, 0.57), (-0.08, -0.62, 0.62), (-0.12, -0.65, 0.65)]
    joint_angles = [[0, -90, 45, 0, 45, 0], [15, -85, 50, 5, 40, 0], [25, -80, 55, 10, 35, 0], [30, -75, 60, 15, 30, 0]]
    
    print("   æ­¥éª¤ 1: ä½ç½® (0.00, -0.50, 0.50) -> å…³èŠ‚è§’åº¦ [0Â°, -90Â°, 45Â°, 0Â°, 45Â°, 0Â°] ç¬é—´è·³è·ƒ!")
    time.sleep(0.3)
    print("   æ­¥éª¤ 2: ä½ç½® (-0.04, -0.57, 0.57) -> å…³èŠ‚è§’åº¦ [15Â°, -85Â°, 50Â°, 5Â°, 40Â°, 0Â°] ç¬é—´è·³è·ƒ!")
    time.sleep(0.3) 
    print("   æ­¥éª¤ 3: ä½ç½® (-0.08, -0.62, 0.62) -> å…³èŠ‚è§’åº¦ [25Â°, -80Â°, 55Â°, 10Â°, 35Â°, 0Â°] ç¬é—´è·³è·ƒ!")
    time.sleep(0.3)
    print("   æ­¥éª¤ 4: ä½ç½® (-0.12, -0.65, 0.65) -> å…³èŠ‚è§’åº¦ [30Â°, -75Â°, 60Â°, 15Â°, 30Â°, 0Â°] ç¬é—´è·³è·ƒ!")
    
    print("\n   ç»“æœ: çœ‹èµ·æ¥æœ‰è¿›åº¦æ¡ï¼Œä½†æœºæ¢°è‡‚æ¯æ­¥éƒ½æ˜¯ç¬é—´ç§»åŠ¨çš„!")
    
    print("\n" + "="*60)
    print("âœ… æ–°çš„è§£å†³æ–¹æ¡ˆ - å…³èŠ‚è§’åº¦å¹³æ»‘æ’å€¼:")
    print("   1. å…ˆè®¡ç®—èµ·å§‹å…³èŠ‚è§’åº¦: [0Â°, -90Â°, 45Â°, 0Â°, 45Â°, 0Â°]")
    print("   2. å†è®¡ç®—ç›®æ ‡å…³èŠ‚è§’åº¦: [30Â°, -75Â°, 60Â°, 15Â°, 30Â°, 0Â°]") 
    print("   3. ç„¶ååœ¨è¿™ä¸¤ç»„è§’åº¦ä¹‹é—´åšå¹³æ»‘æ’å€¼")
    print("   4. æœºæ¢°è‡‚çš„å…³èŠ‚ä¼šè¿ç»­ã€å¹³æ»‘åœ°ä»èµ·å§‹è§’åº¦å˜åŒ–åˆ°ç›®æ ‡è§’åº¦")
    print()
    
    start_angles = [0, -90, 45, 0, 45, 0]
    target_angles = [30, -75, 60, 15, 30, 0] 
    steps = 8
    
    print("   å¹³æ»‘æ’å€¼è¿‡ç¨‹:")
    for i in range(steps + 1):
        alpha = i / steps
        s = alpha**3 * (10 - 15*alpha + 6*alpha*alpha)  # Så‹æ’å€¼
        
        current_angles = []
        for j in range(6):
            angle = (1.0 - s) * start_angles[j] + s * target_angles[j]
            current_angles.append(angle)
        
        progress = i / steps * 100
        print(f"   æ­¥éª¤ {i+1:2}: {progress:5.1f}% -> å…³èŠ‚è§’åº¦ [{current_angles[0]:5.1f}Â°, {current_angles[1]:5.1f}Â°, {current_angles[2]:5.1f}Â°, {current_angles[3]:5.1f}Â°, {current_angles[4]:5.1f}Â°, {current_angles[5]:5.1f}Â°]")
        if i < steps:
            time.sleep(0.2)
    
    print("\n   ç»“æœ: æœºæ¢°è‡‚çš„æ¯ä¸ªå…³èŠ‚éƒ½å¹³æ»‘ã€è¿ç»­åœ°è¿åŠ¨åˆ°ç›®æ ‡ä½ç½®!")
    
def show_implementation_details():
    """æ˜¾ç¤ºå®ç°ç»†èŠ‚"""
    print("\n" + "="*60)
    print("ğŸ› ï¸  å®ç°ç»†èŠ‚:")
    print("   1. è·å–å½“å‰å…³èŠ‚è§’åº¦: start_joint_angles")
    print("   2. é€šè¿‡IKè®¡ç®—ç›®æ ‡å…³èŠ‚è§’åº¦: target_joint_angles")
    print("   3. ä½¿ç”¨Så‹æ’å€¼åœ¨å…³èŠ‚ç©ºé—´ä¸­ç”Ÿæˆè½¨è¿¹")
    print("   4. æ¯ä¸€æ­¥è®¾ç½®æ’å€¼åçš„å…³èŠ‚è§’åº¦ä½œä¸ºæ–°ç›®æ ‡")
    print("   5. è®©PIDæ§åˆ¶å™¨å¹³æ»‘é©±åŠ¨å…³èŠ‚åˆ°ç›®æ ‡è§’åº¦")
    print()
    print("æ ¸å¿ƒä»£ç :")
    print("```python")
    print("# å…³é”®ï¼šæ’å€¼å…³èŠ‚è§’åº¦ï¼Œè€Œä¸æ˜¯æœ«ç«¯ä½ç½®")
    print("current_joint_angles = (1.0 - s) * start_joint_angles + s * target_joint_angles")
    print("")
    print("# ç›´æ¥è®¾ç½®å…³èŠ‚è§’åº¦ç›®æ ‡ï¼ˆå¹³æ»‘è¿‡æ¸¡ï¼‰") 
    print("for j, joint_id in enumerate(c['joints']):")
    print("    controller.joint_targets[joint_id] = current_joint_angles[j]")
    print("```")
    
def main():
    """ä¸»æ¼”ç¤ºç¨‹åº"""
    try:
        demonstrate_smooth_concept()
        show_implementation_details()
        
        print("\n" + "="*60)
        print("ğŸš€ ç°åœ¨çš„ä½¿ç”¨æ–¹æ³•:")
        print("1. python assets/curi1_control_posekeys.py")
        print("2. æŒ‰ 'O' é”®")
        print("3. è¾“å…¥: right -0.12 -0.65 0.65 0 0 0 3")
        print("4. è§‚å¯ŸçœŸæ­£çš„å¹³æ»‘è¿åŠ¨!")
        print()
        print("ä½ ä¼šçœ‹åˆ°:")
        print("ğŸ¯ çœŸæ­£å¹³æ»‘æ§åˆ¶ RIGHT è‡‚ -> ç›®æ ‡ä½ç½® [-0.12 -0.65  0.65] (è€—æ—¶ 3.0ç§’)")
        print("   ç§»åŠ¨è·ç¦»: 15.2cm | å…³èŠ‚å˜åŒ–: 1.23rad")
        print("   è¿›åº¦: 12.5% | å½“å‰ä½ç½®: [-0.004, -0.521, 0.521] | å‰©ä½™: 2.6s")
        print("   è¿›åº¦: 25.0% | å½“å‰ä½ç½®: [-0.018, -0.548, 0.548] | å‰©ä½™: 2.2s")
        print("   ...")
        print("   âœ… å¹³æ»‘è¿åŠ¨å®Œæˆ! | è¿åŠ¨æ¨¡å¼: å…³èŠ‚è§’åº¦å¹³æ»‘æ’å€¼")
        print()
        print("ğŸ‰ ç°åœ¨æ˜¯çœŸæ­£çš„å¹³æ»‘è¿åŠ¨ï¼Œä¸å†æ˜¯åˆ†æ­¥è·³è·ƒ!")
        
    except KeyboardInterrupt:
        print("\nğŸ‘‹ æ¼”ç¤ºè¢«ç”¨æˆ·ä¸­æ–­")

if __name__ == "__main__":
    main()